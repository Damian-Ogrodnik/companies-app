(this["webpackJsonpcompanies-app"]=this["webpackJsonpcompanies-app"]||[]).push([[0],{238:function(e,t,a){e.exports=a(508)},247:function(e,t,a){},508:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),c=a(28),o=a.n(c),u=a(12),i=(a(247),a(32)),l=a(17),s={companies:[],loading:!1,error:null,filteredCompanies:null},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"START_FETCH":return Object(l.a)({},e,{loading:!0});case"FETCH_SUCCESS":return Object(l.a)({},e,{loading:!1,companies:n.companies});case"FETCH_FAILURE":return Object(l.a)({},e,{loading:!1,error:n.error});case"FILTERED_COMPANIES":return Object(l.a)({},e,{filteredCompanies:n.filteredCompanies});default:return e}},m={pageNumber:1,paginatedCompanies:[],loading:!1,error:null},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"SET_PAGE":return Object(l.a)({},e,{pageNumber:n.pageNumber,loading:!0});case"PAGINATE_SUCCESS":return Object(l.a)({},e,{loading:!1,paginatedCompanies:n.paginatedCompanies});case"PAGINATION_FAILURE":return Object(l.a)({},e,{loading:!1,error:n.error});default:return e}},d={incomes:[],loading:!1,error:null,startDate:null,stopDate:null},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"START_FETCH_COMPANY_DETAILS":return Object(l.a)({},e,{loading:!0});case"FETCH_COMPANY_DETAILS_SUCCESS":return Object(l.a)({},e,{loading:!1,incomes:n.incomes});case"FETCH_COMPANY_DETAILS_FAILURE":return Object(l.a)({},e,{loading:!1,error:n.error});case"SET_START_DATE":return Object(l.a)({},e,{startDate:n.startDate});case"SET_STOP_DATE":return Object(l.a)({},e,{stopDate:n.stopDate});case"RESET":return{incomes:[],loading:!1,error:null};default:return e}},b=Object(i.combineReducers)({data:p,pagination:f,companyDetails:E}),v=a(195),O=a(196),h=Object(i.createStore)(b,Object(v.composeWithDevTools)(Object(i.applyMiddleware)(O.a))),y=a(9),g=a.n(y),j=a(13),_=function(e){return{type:"FILTERED_COMPANIES",payload:{filteredCompanies:e}}},N=a(46),w=a.n(N),D=function(){var e=Object(j.a)(g.a.mark((function e(t){var a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.map(function(){var e=Object(j.a)(g.a.mark((function e(t){var a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.get("https://recruitment.hal.skygate.io/incomes/".concat(t.id));case 2:return a=e.sent,n=0,e.next=6,a.data.incomes.forEach((function(e){return n+=parseFloat(e.value)}));case 6:return e.abrupt("return",Object(l.a)({},t,{income:Math.round(100*(n+Number.EPSILON))/100}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:return a=e.sent,n=[],e.next=6,Promise.all(a).then(function(){var e=Object(j.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.sort(S);case 2:n=e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(e,t){var a=e.income,n=t.income,r=0;return a>n?r=1:a<n&&(r=-1),-1*r},T=function(e,t){return function(){var a=Object(j.a)(g.a.mark((function a(n){var r;return g.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,C(e,t);case 3:r=a.sent,n(_(r)),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log(a.t0);case 10:case"end":return a.stop()}}),a,null,[[0,7]])})));return function(e){return a.apply(this,arguments)}}()},C=function(){var e=Object(j.a)(g.a.mark((function e(t,a){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.filter((function(e){return e.name.toLowerCase().includes(t.toLowerCase())}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),A=function(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e.data.companies})),a=function(){var a=Object(j.a)(g.a.mark((function a(n){return g.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e(T(n.target.value,t));case 1:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return r.a.createElement("div",{className:"search"},r.a.createElement("input",{type:"text",className:"search__input",placeholder:"Filter by name ",onChange:function(e){return a(e)}}))},x=function(e){return{type:"SET_PAGE",payload:{pageNumber:e}}},I=function(e){return{type:"PAGINATE_SUCCESS",payload:{paginatedCompanies:e}}},k=function(e){return{type:"PAGINATION_FAILURE",payload:{error:e}}},M=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return(function(){var n=Object(j.a)(g.a.mark((function n(r){var c,o,u;return g.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r(x(e)),o=(c=e*a)-a,n.next=6,t.slice(o,c);case 6:u=n.sent,r(I(u)),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),r(k(n.t0.message));case 13:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e){return n.apply(this,arguments)}}())},P=a(0),F=a(75),L=function(e){var t=e.msg;return r.a.createElement("div",{className:"information"},r.a.createElement(P.b.Provider,{value:{className:"information__icon"}},r.a.createElement(F.a,null)),r.a.createElement("p",null,t))},R=a(16),H=a(122),U=function(e){var t=e.postsPerPage,a=void 0===t?10:t,c=e.companies,o=Object(n.useState)(1),i=Object(R.a)(o,2),l=i[0],s=i[1],p=Object(n.useState)([]),m=Object(R.a)(p,2),f=m[0],d=m[1],E=Object(u.b)();Object(n.useEffect)((function(){(function(){var e=Object(j.a)(g.a.mark((function e(){var t,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],n=1;n<=Math.ceil(c.length/a);n++)t.push(n);d(t);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()(),s(1)}),[c]);var b=function(e){if(f.length>10)return e?r.a.createElement(P.b.Provider,{value:{className:"pagination__arrow left"}},r.a.createElement(H.a,{onClick:function(){return function(){var e=l-1===0?1:l-1;E(M(e,c)),s(e)}()}})):r.a.createElement(P.b.Provider,{value:{className:"pagination__arrow right"}},r.a.createElement(H.b,{onClick:function(){return function(){var e=l===f.length?f.length:l+1;E(M(e,c)),s(e)}()}}))};return r.a.createElement("div",{className:"pagination__wraper"},r.a.createElement("ul",{className:"pagination"},b(!0),function(){var e,t=0;return l<6?(e=0,t=10):l>f.length-9?(e=f.length-10,t=f.length):(e=l-5>0?l-5:0,t=l+5),f.slice(e,t).map((function(e){return r.a.createElement("li",{key:e,className:"pagination__item"+(l===e?"--active":"")},r.a.createElement("button",{onClick:function(){return E(M(t=e,c)),void s(t);var t}},e))}))}(),b(!1)))},Y=a(123),G=a.n(Y),B=function(){var e=Object(j.a)(g.a.mark((function e(t){var a,n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Date,n=a.getMonth()-1,r=0,e.next=5,t.forEach((function(e){var t=e.value,a=e.date;new Date(a).getMonth()===n&&(r+=parseFloat(t))}));case 5:return e.abrupt("return",Math.round(100*(r+Number.EPSILON))/100);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(j.a)(g.a.mark((function e(t){var a,n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.map((function(e){return new Date(e.date)}));case 2:if(a=e.sent,n=new Date(Math.max.apply(null,a)),!((r=new Date(Math.min.apply(null,a)))instanceof Date)||isNaN(r)){e.next=9;break}return e.abrupt("return",{minDate:r,maxDate:n});case 9:return e.abrupt("return",{});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(j.a)(g.a.mark((function e(t,a,n){var r,c,o;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.filter((function(e){var n=e.date;return t<=new Date(n)&&a>=new Date(n)}));case 2:return r=e.sent,c=0,e.next=6,r.forEach((function(e){var t=e.value,a=parseFloat(t);c+=Math.round(100*(a+Number.EPSILON))/100}));case 6:return o=Math.round(100*(c/r.length+Number.EPSILON))/100||0,e.abrupt("return",{totalIncome:Math.round(100*(c+Number.EPSILON))/100,averageIncome:o,filteredIncomes:r});case 8:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),K=a(40),V=function(){var e=Object(j.a)(g.a.mark((function e(t){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.map(function(){var e=Object(j.a)(g.a.mark((function e(t){var a,n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.date,n=t.value,r="".concat(new Date(a).getFullYear(),"-").concat(new Date(a).getMonth()+1),e.abrupt("return",{date:r,income:parseInt(n)});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:return a=e.sent,e.next=5,Promise.all(a).then(function(){var e=Object(j.a)(g.a.mark((function e(t){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W(t);case 2:return a=e.sent,e.abrupt("return",a.sort(X));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(j.a)(g.a.mark((function e(t){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],e.next=3,t.forEach((function(e){this[e.date]||(this[e.date]={date:e.date,income:0},a.push(this[e.date])),this[e.date].income+=e.income}),Object.create(null));case 3:return e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=function(e,t){var a=new Date(e.date),n=new Date(t.date),r=0;return a>n?r=1:a<n&&(r=-1),1*r},q=function(e){var t=e.incomes,a=Object(n.useState)([]),c=Object(R.a)(a,2),o=c[0],u=c[1];return Object(n.useEffect)((function(){V(t).then((function(e){return u(e)}))}),[t]),r.a.createElement("div",{className:"chart"},r.a.createElement("p",null,"COMPANY MONTHLY INCOME"),r.a.createElement(K.c,{width:600,height:200,data:o},r.a.createElement(K.e,{tick:{fill:"#000"},size:10,padding:{right:30},dataKey:"date",interval:1}),r.a.createElement(K.f,{tick:{fill:"#000"}}),r.a.createElement(K.a,{strokeDasharray:"3 3"}),r.a.createElement(K.d,{wrapperStyle:{border:"3px solid #2b2d42",borderRadius:"1rem",overflow:"hidden"}}),r.a.createElement(K.b,{type:"monotone",dataKey:"income",stroke:"#A5A11E"})))},Q=a(126),Z=a.n(Q),$=(a(446),function(){var e=Object(n.useState)(null),t=Object(R.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(null),i=Object(R.a)(o,2),l=i[0],s=i[1],p=Object(n.useState)(new Date),m=Object(R.a)(p,2),f=m[0],d=m[1],E=Object(n.useState)(new Date),b=Object(R.a)(E,2),v=b[0],O=b[1],h=Object(u.b)(),y=Object(u.c)((function(e){return e.companyDetails.incomes}));return Object(n.useEffect)((function(){Boolean(y)&&z(y).then((function(e){var t=e.minDate,n=e.maxDate;t&&n&&(d(new Date(t)),O(new Date(n)),a||l||(s(new Date(t)),c(new Date(n))))}))}),[y,a,l]),Object(n.useEffect)((function(){h(function(e,t){return function(){var a=Object(j.a)(g.a.mark((function a(n){return g.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:try{n({type:"SET_START_DATE",payload:{startDate:e}}),n({type:"SET_STOP_DATE",payload:{stopDate:t}})}catch(r){console.log(r)}case 1:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}(f,v))}),[f,v]),r.a.createElement("div",{className:"company-details__date-range"},r.a.createElement("p",null,"SELECT INCOME DATE RANGE"),r.a.createElement("div",{className:"company-details__datepickers"},r.a.createElement("div",{className:"company-details__datepicker"},r.a.createElement("p",null,"START DATE"),r.a.createElement(Z.a,{selected:f,onChange:function(e){return d(e)},selectsStart:!0,startDate:f,endDate:v,minDate:l,placeholderText:"Select start date range"})),r.a.createElement("div",{className:"company-details__datepicker"},r.a.createElement("p",null,"STOP DATE"),r.a.createElement(Z.a,{selected:v,onChange:function(e){return O(e)},selectsEnd:!0,startDate:f,endDate:v,minDate:f,maxDate:a,placeholderText:"Select stop date range"}))))}),ee=a(208),te=function(){return r.a.createElement("div",{className:"error"},r.a.createElement(P.b.Provider,{value:{className:"error__icon"}},r.a.createElement(F.a,null)),r.a.createElement("p",null,"Ooops... Something went wrong."),r.a.createElement("p",null,"Try again later."))},ae=a(207),ne=a.n(ae),re=function(){return r.a.createElement("div",{className:"loader"},r.a.createElement(ne.a,{size:25,color:"#e2dd28",loading:!0}))},ce=function(e){return function(t){var a=t.error,n=t.loading,c=Object(ee.a)(t,["error","loading"]);return n?r.a.createElement(re,null):a?r.a.createElement(te,null):r.a.createElement(e,c)}},oe=ce((function(e){var t=e.basicData,a=t.id,c=t.city,o=t.name,i=e.openModal,l=Object(n.useState)(0),s=Object(R.a)(l,2),p=s[0],m=s[1],f=Object(n.useState)(0),d=Object(R.a)(f,2),E=d[0],b=d[1],v=Object(n.useState)(0),O=Object(R.a)(v,2),h=O[0],y=O[1],_=Object(n.useState)([]),N=Object(R.a)(_,2),D=N[0],S=N[1],T=Object(u.b)(),C=Object(u.c)((function(e){return e.companyDetails.incomes})),A=Object(u.c)((function(e){return e.companyDetails.startDate})),x=Object(u.c)((function(e){return e.companyDetails.stopDate}));return Object(n.useEffect)((function(){i&&!C.length&&T(function(e){return function(){var t=Object(j.a)(g.a.mark((function t(a){var n;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a({type:"START_FETCH_COMPANY_DETAILS"});case 3:return t.next=5,w.a.get("https://recruitment.hal.skygate.io/incomes/".concat(e));case 5:n=t.sent,a({type:"FETCH_COMPANY_DETAILS_SUCCESS",payload:{incomes:n.data.incomes}}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),a({type:"FETCH_COMPANY_DETAILS_FAILURE",payload:{error:t.t0.message}});case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()}(a))}),[]),Object(n.useEffect)((function(){i&&B(C).then((function(e){return m(e)}))}),[C]),Object(n.useEffect)((function(){i&&J(A,x,C).then((function(e){var t=e.totalIncome,a=e.averageIncome,n=e.filteredIncomes;b(t),y(a),console.log(n),S(n)}))}),[A,x,C]),r.a.createElement("div",{className:"company-details"},r.a.createElement("h2",null,"DETAILS"),r.a.createElement("div",{className:"company-details__header"},r.a.createElement("p",null,"ID"),r.a.createElement("p",null,"NAME"),r.a.createElement("p",null,"CITY")),r.a.createElement("div",{className:"company-details__basic-info"},r.a.createElement("p",null,a),r.a.createElement("p",null,o),r.a.createElement("p",null,c)),r.a.createElement("div",{className:"company-details__incomes"},r.a.createElement("div",{className:"company-details__incomes income"},r.a.createElement("p",null,"TOTAL INCOME"),r.a.createElement("p",null,E)),r.a.createElement("div",{className:"company-details__incomes income"},r.a.createElement("p",null,"AVERAGE INCOME"),r.a.createElement("p",null,h)),r.a.createElement("div",{className:"company-details__incomes income"},r.a.createElement("p",null,"LAST MONTH INCOME"),r.a.createElement("p",null,p))),r.a.createElement($,null),r.a.createElement(q,{incomes:D}))})),ue=function(e){var t=e.basicData,a=e.openModal,n=e.setOpenModal,c=Object(u.b)(),o=Object(u.c)((function(e){return e.companyDetails.error})),i=Object(u.c)((function(e){return e.companyDetails.loading}));return G.a.setAppElement("body"),r.a.createElement(G.a,{isOpen:a,contentLabel:"details",className:"modal",overlayClassName:"overlay"},r.a.createElement(oe,{loading:i,error:o,basicData:t,openModal:a}),r.a.createElement("div",{className:"company-details__close"},r.a.createElement("button",{onClick:function(){n(!1),c({type:"RESET"})}},"X")))},ie=function(e){var t=e.id,a=e.name,c=e.city,o=e.income,u=e.details,i=void 0!==u&&u,l=e.header,s=void 0!==l&&l,p=Object(n.useState)(!1),m=Object(R.a)(p,2),f=m[0],d=m[1];return r.a.createElement("li",{className:"table__row"+(s?" header":"")},r.a.createElement("p",null,t),r.a.createElement("p",null,a),r.a.createElement("p",null,c),r.a.createElement("p",null,o),i||r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"table__row__button",onClick:function(){return d(!0)}},"Details"),r.a.createElement(ue,{basicData:{id:t,name:a,city:c,income:o},openModal:f,setOpenModal:d})))},le=ce((function(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e.data.companies})),a=Object(u.c)((function(e){return e.data.filteredCompanies})),c=Object(u.c)((function(e){return e.pagination.paginatedCompanies}));return Object(n.useEffect)((function(){t.length||e(function(){var e=Object(j.a)(g.a.mark((function e(t){var a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t({type:"START_FETCH"});case 3:return e.next=5,w.a.get("https://recruitment.hal.skygate.io/companies");case 5:return a=e.sent,e.next=8,D(a.data);case 8:n=e.sent,t({type:"FETCH_SUCCESS",payload:{companies:n}}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),t({type:"FETCH_FAILURE",payload:{error:e.t0.message}});case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(n.useEffect)((function(){e(M(1,a||t))}),[t,e,a]),r.a.createElement("ul",null,0!==Object.keys(c).length&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ie,{id:"ID",name:"NAME",city:"CITY",income:"INCOME",header:!0,details:"MORE"}),c.map((function(e){var t=e.id,a=e.name,n=e.city,c=e.income;return r.a.createElement(ie,{key:t,id:t,name:a,city:n,income:c})})),r.a.createElement(U,{companies:a||t})),Boolean(!Object.keys(c).length)&&r.a.createElement(L,{msg:"NOTHING FOUND"}))})),se=function(){var e=Object(u.c)((function(e){return e.data.error})),t=Object(u.c)((function(e){return e.data.loading}));return r.a.createElement("div",{className:"table"},r.a.createElement("div",{className:"table__wrapper"},r.a.createElement(le,{loading:t,error:e})))};o.a.render(r.a.createElement((function(){return r.a.createElement(u.a,{store:h},r.a.createElement("div",{className:"App"},r.a.createElement(A,null),r.a.createElement(se,null)))}),null),document.getElementById("root"))}},[[238,1,2]]]);
//# sourceMappingURL=main.39171ed3.chunk.js.map